function Qs = Qdiff(zvec,p,A,Qd);% function Qs = Qdiff(zvec,p,A,Qd);% 	diffuse solar flux density%  zvec   : solar zenith angle  (rad)%  zd     : solar zenith angle  (¡)%  p      : barometric pressure (Pa)%  A      : local albedo%  Qd     : direct beam solar flux density  (W/m2)%  Qs     : skylight flux density  (W/m2)zd     = zvec * (180/pi);toobig = (zd >= 88);zt = (zvec.*(1-toobig)) + (87.9*toobig*(pi/180));small = (zd <= 50);Qs = (small.*Skysmall(zt,p,A,Qd)) + ((1-small).*Skylarge(zt,p,A,Qd));