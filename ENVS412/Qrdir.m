function Sb = Qrdir(zvec,p,w,d);% function Sb = Qrdir(zvec,p,w,d );% 	dierct beam solar flux density%  p       : atmospheric pressure (Pa)%  po      : atmospheric pressure at sea level (Pa)%  m       : air mass #%  w       : precipitable water (m)%  d       : dust (particles/cm3)%  zvec    : solar zenith angle (rad)%  Spo     : solar constant (W/m2)%  Sb      : direct beam solar flux density (W/m2)[c,r] = size(zvec);if (r > c),  zvec = zvec'; end;Spo   = 1373;po    = 1.013E5;cosz  = max([cos(zvec'); zeros(size(zvec'))])';m     = (p/po) ./ (cosz + (0.025 * exp(-11.0*cosz)));gas   = 0.089 * (p .* m / po).^0.75;water = 0.174 * (w .* m / 0.02).^0.6;dust  = 0.083 * (d .* m).^0.9;Sb    = Spo * exp( -(gas + water + dust)) .* (abs(zvec) <= (pi/2));